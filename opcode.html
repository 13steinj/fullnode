<!DOCTYPE html><html lang="en"><head><title>opcode</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="opcode"><meta name="groc-project-path" content="lib/opcode.js"><meta name="groc-github-url" content="https://github.com/ryanxcharles/fullnode"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/ryanxcharles/fullnode/blob/master/lib/opcode.js">lib/opcode.js</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Opcode</span><span class="hljs-params">(num)</span> {</span>
  <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Opcode))
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Opcode(num);

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> num === <span class="hljs-string">'number'</span>) {
    <span class="hljs-keyword">this</span>.num = num;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> num === <span class="hljs-string">'string'</span>) {
    <span class="hljs-keyword">var</span> str = num;
    <span class="hljs-keyword">this</span>.num = Opcode.map[str];
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (num) {
    <span class="hljs-keyword">var</span> obj = num;
    <span class="hljs-keyword">this</span>.set(obj);
  }
}

Opcode.prototype.set = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> {</span>
  <span class="hljs-keyword">this</span>.num = <span class="hljs-keyword">typeof</span> obj.num !== <span class="hljs-string">'undefined'</span> ? obj.num : <span class="hljs-keyword">this</span>.num;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Opcode.prototype.fromNumber = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(num)</span> {</span>
  <span class="hljs-keyword">this</span>.num = num;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Opcode.prototype.toNumber = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.num;
};

Opcode.prototype.fromString = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(str)</span> {</span>
  <span class="hljs-keyword">var</span> num = Opcode.map[str];
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> num === <span class="hljs-string">'undefined'</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Invalid opcodestr'</span>);
  <span class="hljs-keyword">this</span>.num = num;
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Opcode.prototype.toString = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">var</span> str = Opcode.reverseMap[<span class="hljs-keyword">this</span>.num];
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> str === <span class="hljs-string">'undefined'</span>)
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Opcode does not have a string representation'</span>);
  <span class="hljs-keyword">return</span> str;
};

Opcode.map = {</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>push value</p></div></div><div class="code"><div class="wrapper">  OP_FALSE: <span class="hljs-number">0</span>,
  OP_0: <span class="hljs-number">0</span>,
  OP_PUSHDATA1: <span class="hljs-number">76</span>,
  OP_PUSHDATA2: <span class="hljs-number">77</span>,
  OP_PUSHDATA4: <span class="hljs-number">78</span>,
  OP_1NEGATE: <span class="hljs-number">79</span>,
  OP_RESERVED: <span class="hljs-number">80</span>,
  OP_TRUE: <span class="hljs-number">81</span>,
  OP_1: <span class="hljs-number">81</span>,
  OP_2: <span class="hljs-number">82</span>,
  OP_3: <span class="hljs-number">83</span>,
  OP_4: <span class="hljs-number">84</span>,
  OP_5: <span class="hljs-number">85</span>,
  OP_6: <span class="hljs-number">86</span>,
  OP_7: <span class="hljs-number">87</span>,
  OP_8: <span class="hljs-number">88</span>,
  OP_9: <span class="hljs-number">89</span>,
  OP_10: <span class="hljs-number">90</span>,
  OP_11: <span class="hljs-number">91</span>,
  OP_12: <span class="hljs-number">92</span>,
  OP_13: <span class="hljs-number">93</span>,
  OP_14: <span class="hljs-number">94</span>,
  OP_15: <span class="hljs-number">95</span>,
  OP_16: <span class="hljs-number">96</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>control</p></div></div><div class="code"><div class="wrapper">  OP_NOP: <span class="hljs-number">97</span>,
  OP_VER: <span class="hljs-number">98</span>,
  OP_IF: <span class="hljs-number">99</span>,
  OP_NOTIF: <span class="hljs-number">100</span>,
  OP_VERIF: <span class="hljs-number">101</span>,
  OP_VERNOTIF: <span class="hljs-number">102</span>,
  OP_ELSE: <span class="hljs-number">103</span>,
  OP_ENDIF: <span class="hljs-number">104</span>,
  OP_VERIFY: <span class="hljs-number">105</span>,
  OP_RETURN: <span class="hljs-number">106</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>stack ops</p></div></div><div class="code"><div class="wrapper">  OP_TOALTSTACK: <span class="hljs-number">107</span>,
  OP_FROMALTSTACK: <span class="hljs-number">108</span>,
  OP_2DROP: <span class="hljs-number">109</span>,
  OP_2DUP: <span class="hljs-number">110</span>,
  OP_3DUP: <span class="hljs-number">111</span>,
  OP_2OVER: <span class="hljs-number">112</span>,
  OP_2ROT: <span class="hljs-number">113</span>,
  OP_2SWAP: <span class="hljs-number">114</span>,
  OP_IFDUP: <span class="hljs-number">115</span>,
  OP_DEPTH: <span class="hljs-number">116</span>,
  OP_DROP: <span class="hljs-number">117</span>,
  OP_DUP: <span class="hljs-number">118</span>,
  OP_NIP: <span class="hljs-number">119</span>,
  OP_OVER: <span class="hljs-number">120</span>,
  OP_PICK: <span class="hljs-number">121</span>,
  OP_ROLL: <span class="hljs-number">122</span>,
  OP_ROT: <span class="hljs-number">123</span>,
  OP_SWAP: <span class="hljs-number">124</span>,
  OP_TUCK: <span class="hljs-number">125</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>splice ops</p></div></div><div class="code"><div class="wrapper">  OP_CAT: <span class="hljs-number">126</span>,
  OP_SUBSTR: <span class="hljs-number">127</span>,
  OP_LEFT: <span class="hljs-number">128</span>,
  OP_RIGHT: <span class="hljs-number">129</span>,
  OP_SIZE: <span class="hljs-number">130</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>bit logic</p></div></div><div class="code"><div class="wrapper">  OP_INVERT: <span class="hljs-number">131</span>,
  OP_AND: <span class="hljs-number">132</span>,
  OP_OR: <span class="hljs-number">133</span>,
  OP_XOR: <span class="hljs-number">134</span>,
  OP_EQUAL: <span class="hljs-number">135</span>,
  OP_EQUALVERIFY: <span class="hljs-number">136</span>,
  OP_RESERVED1: <span class="hljs-number">137</span>,
  OP_RESERVED2: <span class="hljs-number">138</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>numeric</p></div></div><div class="code"><div class="wrapper">  OP_1ADD: <span class="hljs-number">139</span>,
  OP_1SUB: <span class="hljs-number">140</span>,
  OP_2MUL: <span class="hljs-number">141</span>,
  OP_2DIV: <span class="hljs-number">142</span>,
  OP_NEGATE: <span class="hljs-number">143</span>,
  OP_ABS: <span class="hljs-number">144</span>,
  OP_NOT: <span class="hljs-number">145</span>,
  OP_0NOTEQUAL: <span class="hljs-number">146</span>,

  OP_ADD: <span class="hljs-number">147</span>,
  OP_SUB: <span class="hljs-number">148</span>,
  OP_MUL: <span class="hljs-number">149</span>,
  OP_DIV: <span class="hljs-number">150</span>,
  OP_MOD: <span class="hljs-number">151</span>,
  OP_LSHIFT: <span class="hljs-number">152</span>,
  OP_RSHIFT: <span class="hljs-number">153</span>,

  OP_BOOLAND: <span class="hljs-number">154</span>,
  OP_BOOLOR: <span class="hljs-number">155</span>,
  OP_NUMEQUAL: <span class="hljs-number">156</span>,
  OP_NUMEQUALVERIFY: <span class="hljs-number">157</span>,
  OP_NUMNOTEQUAL: <span class="hljs-number">158</span>,
  OP_LESSTHAN: <span class="hljs-number">159</span>,
  OP_GREATERTHAN: <span class="hljs-number">160</span>,
  OP_LESSTHANOREQUAL: <span class="hljs-number">161</span>,
  OP_GREATERTHANOREQUAL: <span class="hljs-number">162</span>,
  OP_MIN: <span class="hljs-number">163</span>,
  OP_MAX: <span class="hljs-number">164</span>,

  OP_WITHIN: <span class="hljs-number">165</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>crypto</p></div></div><div class="code"><div class="wrapper">  OP_RIPEMD160: <span class="hljs-number">166</span>,
  OP_SHA1: <span class="hljs-number">167</span>,
  OP_SHA256: <span class="hljs-number">168</span>,
  OP_HASH160: <span class="hljs-number">169</span>,
  OP_HASH256: <span class="hljs-number">170</span>,
  OP_CODESEPARATOR: <span class="hljs-number">171</span>,
  OP_CHECKSIG: <span class="hljs-number">172</span>,
  OP_CHECKSIGVERIFY: <span class="hljs-number">173</span>,
  OP_CHECKMULTISIG: <span class="hljs-number">174</span>,
  OP_CHECKMULTISIGVERIFY: <span class="hljs-number">175</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>expansion</p></div></div><div class="code"><div class="wrapper">  OP_NOP1: <span class="hljs-number">176</span>,
  OP_NOP2: <span class="hljs-number">177</span>,
  OP_NOP3: <span class="hljs-number">178</span>,
  OP_NOP4: <span class="hljs-number">179</span>,
  OP_NOP5: <span class="hljs-number">180</span>,
  OP_NOP6: <span class="hljs-number">181</span>,
  OP_NOP7: <span class="hljs-number">182</span>,
  OP_NOP8: <span class="hljs-number">183</span>,
  OP_NOP9: <span class="hljs-number">184</span>,
  OP_NOP10: <span class="hljs-number">185</span>,</div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>template matching params</p></div></div><div class="code"><div class="wrapper">  OP_PUBKEYHASH: <span class="hljs-number">253</span>,
  OP_PUBKEY: <span class="hljs-number">254</span>,
  OP_INVALIDOPCODE: <span class="hljs-number">255</span>
};

Opcode.reverseMap = [];

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k <span class="hljs-keyword">in</span> Opcode.map) {
  <span class="hljs-keyword">if</span> (Opcode.map.hasOwnProperty(k)) {
    Opcode.reverseMap[Opcode.map[k]] = k;
  }
}

module.exports = Opcode;</div></div></div></div></body></html>